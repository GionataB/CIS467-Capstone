<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: routing/admin/course_admin.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: routing/admin/course_admin.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * The module provides definitions for all REST requests and routes that handle the admin side of the server.
 * The routes contained in the module connect to a specific collection of the database that stores 'courses'.
 * @module routing/admin/course_admin
 * @requires error_handling/Error
 * @requires express
 * @requires schemas/admin/course_schema
 * @requires config/routes
 * @requires routing/admin/queries/question_queries
 * @requires routines/http_routines
 */

const error_handler = require('../../error_handling/Error');
const express = require('express');
const router = express.Router();

const db_admin = require('../../schemas/admin/course_schema');
const {courseRoute} = require('../../config/routes');
const queries = require('./queries/admin_queries');
const routines = require('../../routines/http_routines');

/**
 * The POST request creates entries in the database, in the &lt;code>Course&lt;/code>.
 * The POST will create, not update, an entry in the database.&lt;br>
 * PUT should be used to update a database entry.
 * By default &lt;code>option = '1'&lt;/code>.&lt;br>
 * Available options:&lt;ul>
 * &lt;li>&lt;code>0&lt;/code>: post many elements as an array of JSON objects, each separated by a comma. &lt;br>Example: &lt;code>[{object 1}, {object 2}, ...].&lt;/code>&lt;/li>
 * &lt;li>&lt;code>1&lt;/code>: post a single element as a JSON object. &lt;br>Example: &lt;code>{object}&lt;/code>&lt;/li>
 * &lt;/ul>
 * If the option passed does not match any of the provided options, a &lt;code>400 Bad Request&lt;/code> is sent back as response.&lt;br>&lt;br>
 * Example of a request to add a single element:&lt;br>
 * &lt;code>{&lt;br>params: {
 * &lt;p style="LINE-HEIGHT:0px; margin-left: 40px">option: '1'},&lt;/p>
 * body: {JSON object}&lt;br>}&lt;/code>&lt;br>&lt;br>
 * Example of a request to add multiple elements:&lt;br>
 * &lt;code>{&lt;br>params: {
 * &lt;p style="LINE-HEIGHT:0px; margin-left: 40px">option: '0'},&lt;/p>
 * body: [{object 1}, {object 2}, ...]&lt;br>}&lt;/code>
 * @callback postRoute
 * @param {Object} req the request received from a client
 * @param {Object} res the response from the server
 * @see putRoute
 */
router.route(courseRoute).post(function(req, res) {
    var opt = req.query.option || '1';
    var docs = req.body;
    switch (opt){
      case '0':
        routines.post_many(res, queries, db_admin, docs);
        break;
      case '1':
        var db_entry = new db_admin(docs);
        routines.post_one(res, queries, db_entry);
        break;
      default:
          error_handler.badClientRequest(res, "Could not understand 'option' value");
          break;
    }
  });
  
/**
 * The GET request offers different options, passed in the request as an &lt;code>option&lt;/code> field in the parameters. By default &lt;code>option = '0'&lt;/code>.&lt;br>
 * Available options:&lt;ul>
 * &lt;li>&lt;code>0&lt;/code>: get all the database. This does not require the &lt;code>name&lt;/code> parameter in the request, although its presence does not cause an error.&lt;/li>
 * &lt;li>&lt;code>1&lt;/code>: asks the database for the entry with matching tag. Only one entry is returned.&lt;br> If the tag is empty or &lt;code>null&lt;/code>, a null element is returned.&lt;/li>&lt;/ul>
 * If the option passed does not match any of the provided options, a &lt;code>400 Bad Request&lt;/code> is sent back as response.&lt;br>&lt;br>
 * Example of a request to get an element with tag &lt;code>CIS 467&lt;/code>:&lt;br>
 * &lt;code>{&lt;br>params: {
 * &lt;p style="LINE-HEIGHT:5px; margin-left: 40px">option: '1',&lt;/p>
 * &lt;p style="LINE-HEIGHT:5px; margin-left: 40px">name: 'CIS 467'}&lt;/p>
 * }&lt;/code>&lt;br>&lt;br>
 * Example of a request to get all the elements:&lt;br>
 * &lt;code>{&lt;br>params: {
 * &lt;p style="LINE-HEIGHT:0px; margin-left: 40px">option: '0'&lt;/p>
 * }&lt;/code>&lt;br>&lt;br>
 * @callback getRoute
 * @param {Object} req the request received from a client
 * @param {Object} res the response from the server
 */
router.route(courseRoute).get(function(req, res) {
  var id = req.query.name;
  var opt = req.query.option || '0';
  switch (opt) {
    case '0':
      routines.get_all(res, queries, db_admin);
      break;
      
    case '1':
      routines.get_one(res, queries, db_admin, {tag: id}, '');
      break;
  
    default:
      error_handler.badClientRequest(res, "Could not understand 'option' value");
      break;
    }
  });
  
/**
 * The PUT request is used to modify one entry in the database.
 * The entry has to exist in the database, it does not create one.&lt;br>
 * The validators in the schema will be checked on update: for example, an element's tag cannot be updated if the new tag is already existing in the database.&lt;br>&lt;br>
 * Example of a request to update the description to of &lt;code>CIS 467&lt;/code> to &lt;code>Example&lt;/code>:&lt;br>
 * &lt;code>{&lt;br>params: {
 * &lt;p style="LINE-HEIGHT:0px; margin-left: 40px">name: 'CIS 467'},&lt;/p>
 * body: {
 * &lt;p style="LINE-HEIGHT:0px; margin-left: 40px">description: 'Example'}&lt;/p>
 * }&lt;/code>&lt;br>&lt;br>
 * 
 * @callback putRoute
 * @param {Object} req the request received from a client
 * @param {Object} res the response from the server
 */
router.route(courseRoute).put(function(req, res) {
  var id = req.query.name;
  var update_param = req.body;
  routines.update_one_doc(res, queries, db_admin, {tag: id}, update_param);
});
  
/**
 * The DELETE request is used to remove entries in the database.
 * Different delete functions are provided, and the option to choose it is passed in the &lt;code>option&lt;/code> field in the parameters.&lt;br>
 * By default &lt;code>option = '1'&lt;/code>.&lt;br>
 * The option is a string, and the supported options are the following:&lt;ul>
 * &lt;li>&lt;code>0&lt;/code>: delete all elements. Does not require a &lt;code>name&lt;/code> field in the request.&lt;/li>
 * &lt;li>&lt;code>1&lt;/code>: delete a single element.&lt;/li>&lt;/ul>
 * If the option passed does not match any of the provided options, a &lt;code>400 Bad Request&lt;/code> is sent back as response.&lt;br>&lt;br>
 * Example of a request to delete the element with tag &lt;code>CIS 467&lt;/code>:&lt;br>
 * &lt;code>{&lt;br>params: {
 * &lt;p style="LINE-HEIGHT:5px; margin-left: 40px">option: '1',&lt;/p>
 * &lt;p style="LINE-HEIGHT:5px; margin-left: 40px">name: 'CIS 467'}&lt;/p>
 * }&lt;/code>&lt;br>&lt;br>
 * Example of a request to delete all the elements:&lt;br>
 * &lt;code>{&lt;br>params: {
 * &lt;p style="LINE-HEIGHT:5px; margin-left: 40px">option: '0'&lt;/p>
 * }&lt;/code>&lt;br>&lt;br>
 * 
 * @callback deleteRoute
 * @param {Object} req the request received from a client
 * @param {Object} res the response from the server
 */
router.route(courseRoute).delete(function(req, res) {
  var id = req.query.name;
  var opt = req.query.option;
  if (opt == null &amp;&amp; id != null) opt = '1';
  switch (opt){
    case '0':
      routines.delete_all(res, queries, db_admin);
      break;
  
    case '1':
      routines.delete_one(res, queries, db_admin, {tag: id});
      break;
      
    default:
      error_handler.badClientRequest(res, "Could not understand 'option' value");
      break;
    }
  });
  
  module.exports = router;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-config_keys.html">config/keys</a></li><li><a href="module-config_routes.html">config/routes</a></li><li><a href="module-error_handling_Error.html">error_handling/Error</a></li><li><a href="module-routines_http_routines.html">routines/http_routines</a></li><li><a href="module-routing_admin_course_admin.html">routing/admin/course_admin</a></li><li><a href="module-routing_admin_queries_admin_queries.html">routing/admin/queries/admin_queries</a></li><li><a href="module-routing_admin_question_admin.html">routing/admin/question_admin</a></li><li><a href="module-routing_root_route.html">routing/root_route</a></li><li><a href="module-routing_user_queries_queries.html">routing/user/queries/queries</a></li><li><a href="module-routing_user_router_user.html">routing/user/router_user</a></li><li><a href="module-schemas_admin_course_schema.html">schemas/admin/course_schema</a></li><li><a href="module-schemas_admin_question_schema.html">schemas/admin/question_schema</a></li><li><a href="module-server.html">server</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Dec 10 2019 00:28:42 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
